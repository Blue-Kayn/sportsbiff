<%= form_with model: [chat, message], id: "new_message_form", class: "flex gap-3", data: { turbo_stream: true, chat_form: true } do |f| %>
  <%= f.text_field :content,
      class: "flex-1 bg-gray-800 text-white border border-gray-700 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent placeholder-gray-500",
      placeholder: "Ask about NFL odds, spreads, props...",
      autocomplete: "off",
      autofocus: true,
      data: { chat_input: true } %>
  <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg transition cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center" style="min-width: 48px; min-height: 48px;">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>
<% end %>

<script>
  document.getElementById("new_message_form").addEventListener("turbo:submit-start", function(event) {
    const input = this.querySelector("[data-chat-input]")
    if (input) {
      setTimeout(() => { input.value = "" }, 0)
    }
  })
</script>
